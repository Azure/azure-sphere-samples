# Sample: Use CMake

This sample shows how to use CMake to build an Azure Sphere application. CMake is an alternative to Visual Studio projects.

This repository contains a sample CMake project that uses the same code as the [Visual Studio Blink template](https://docs.microsoft.com/azure-sphere/quickstarts/qs-blink-application#build-and-run-the-blink-sample). The Azure Sphere SDK for Visual Studio supplies supporting CMake toolchain files. The toolchain files configure CMake to build Azure Sphere applications with the appropriate cross compilers and compilation flags.

The sample contains two files in addition to the usual Blink template files:

- CMakeSettings.txt contains the toolchain information and produces the build.
- CMakeSettings.json configures Visual Studio to use CMake with the correct command line options.

The CMake preview supports build only at this time. It produces an image package that can be deployed to an Azure Sphere device using the **azsphere** utility. Deployment and debugging from Visual Studio are not currently supported. 

To use this sample, clone the repository locally if you haven't already done so:

     `git clone https://github.com/Azure/azure-sphere-samples.git`

## To build with Visual Studio 

To build the sample with CMake and Visual Studio, use the following steps.

1. Open the root folder of the sample in Visual Studio. Under the **File** menu, click **Open**, and then click **Folder** and browse to the CMakeSample folder. 

   Visual Studio will recognize the presence of CMakeLists.txt, and use the CMakeSettings.json file to automatically generate the CMake cache. The CMakeSettings.json file provides information that Visual Studio uses to provide IntelliSense, build targets, and to pass parameters to CMake. See the CMake parameters section for parameters specific to Azure Sphere.
1. To build in Visual Studio, on the **CMake** menu click the **Build All** option, or right-click the CMakeLists.txt file in Solution Explorer and select **Build All**. 

   You will see the output location of your Azure Sphere application in the Output window. You can also navigate to the output location through the **CMake** menu, and then select **Open Cache Folder**.

## To deploy the application generated by CMake

Open an Azure Sphere Developer Command Prompt. Change to the directory that contains the image package and run the **azsphere device sideload deploy** command:

    `azsphere.exe device sideload deploy -p CMakeSample.imagepackage`

## License
For license details, see LICENSE.txt.

## Code of Conduct
This project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/).
